{# all:
  hosts:
    master1:
      ansible_host: {{ 10.148.0.14    }}
      ansible_user: pisethkhon888
      ansible_ssh_private_key_file: {{ ssh_private_key_file }}
    {% for ip in worker_ips %}
    node{{ loop.index }}:
      ansible_host: {{ ip }}
      ansible_user: pisethkhon888
      ansible_ssh_private_key_file: {{ ssh_private_key_file }}
    {% endfor %}
  children:
    kube_control_plane:
      hosts:
        master1:
    kube_nodes:
      hosts:
        {% for ip in worker_ips %}
        node{{ loop.index }}:
        {% endfor %}
    etcd:
      hosts:
        master1:
    k8s_cluster:
      children:
        kube_control_plane:
        kube_nodes: #}
all:
  hosts:
    {{ master.name }}:
      ansible_host: {{ master.internal_ip }}
      ansible_user: {{ ansible_user }}
      ansible_ssh_private_key_file: {{ ssh_private_key_file }}

{# {% for node in workers %}
    {{ node.name }}:
      ansible_host: {{ node.internal_ip }}
      ansible_user: {{ ansible_user }}
      ansible_ssh_private_key_file: {{ ssh_private_key_file }}
{% endfor %} #}

{% for node in workers | default([]) %}
    {{ node.name }}:
      ansible_host: {{ node.internal_ip | default('') }}
      ansible_user: {{ ansible_user }}
      ansible_ssh_private_key_file: {{ ssh_private_key_file }}
{% endfor %}


  children:
    kube_control_plane:
      hosts:
        {{ master.name }}:
    kube_nodes:
      hosts:
{% for node in workers %}
        {{ node.name }}:
{% endfor %}
    etcd:
      hosts:
        {{ master.name }}:
    k8s_cluster:
      children:
        kube_control_plane:
        kube_nodes:


